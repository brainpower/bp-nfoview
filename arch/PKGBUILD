# Maintainer: brainpower <brainpower at gulli dot com>

pkgname="bp-nfoview"
pkgver=20120924
pkgrel=1
pkgdesc="A Simple NFO-Viewer by brainpower"
arch=('i686' 'x86_64')
url="https://github.com/brainpower/bp-nfoview"
license=('GPL')
depends=('qt4')
makedepends=('cmake' 'git')
source=("${pkgname}::git://github.com/brainpower/bp-nfoview.git")
sha256sums=('SKIP')
install=bp-nfoview.install

pkgver(){
	cd "$srcdir/$pkgname"
	echo $(git log -1 --format="%ci" | sed 's/\(.*\)-\(.*\)-\(.*\) .* .*/\1\2\3/')
}

build(){
  cd "${srcdir}"

  rm -rf "${srcdir}/${pkgname}-build"
  git clone "${srcdir}/${pkgname}" "${srcdir}/${pkgname}-build"
  cd "${srcdir}/${pkgname}-build"

	[[ -d build ]] && rm -rvf build/
  mkdir build/
  cd build/

  cmake .. \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_BUILD_TYPE=Release

  make ${MAKEFLAGS}
}

package(){
  cd "${srcdir}/${pkgname}-build/build"
	make install DESTDIR="${pkgdir}"
}
